(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[698],{345:(e,t,s)=>{Promise.resolve().then(s.bind(s,5782))},5782:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>n});var a=s(5155),l=s(2115),r=s(63),i=s(5125);function n(){let e=(0,r.useRouter)(),[t,s]=(0,l.useState)([]),[n,d]=(0,l.useState)([]),[c,o]=(0,l.useState)(!0),[h,x]=(0,l.useState)(!1);(0,l.useEffect)(()=>{let t=localStorage.getItem("token");if(!t)return void e.push("/login");x(!0),m(t)},[e]);let m=async e=>{try{let[t,a]=await Promise.all([i.A.get("/api/reservations?admin=true",{headers:{Authorization:"Bearer ".concat(e)}}),i.A.get("/api/reviews")]);s(t.data),d(a.data)}catch(e){console.error(e),alert("데이터를 불러오는데 실패했습니다.")}finally{o(!1)}},u=async e=>{if(!confirm("정말 이 후기를 삭제하시겠습니까?"))return;let t=localStorage.getItem("token");try{await i.A.delete("/api/reviews/".concat(e),{headers:{Authorization:"Bearer ".concat(t)}}),alert("후기가 삭제되었습니다."),d(n.filter(t=>t.id!==e))}catch(e){alert("삭제 실패")}};return h?(0,a.jsxs)("div",{className:"default-container py-10",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center mb-8",children:[(0,a.jsx)("h1",{className:"text-3xl font-bold",children:"관리자 대시보드"}),(0,a.jsx)("button",{onClick:()=>{localStorage.removeItem("token"),e.push("/login")},className:"text-red-500 hover:underline",children:"로그아웃"})]}),(0,a.jsx)("div",{className:"flex gap-4 mb-8",children:(0,a.jsx)("button",{onClick:()=>e.push("/admin/reviews/write"),className:"px-6 py-3 bg-blue-600 text-white rounded hover:bg-blue-700 font-bold",children:"+ 훈련 후기 작성하기"})}),(0,a.jsxs)("div",{className:"grid lg:grid-cols-2 gap-8",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h2",{className:"text-2xl font-bold mb-4",children:"예약 현황 (전체)"}),c?(0,a.jsx)("p",{children:"로딩 중..."}):(0,a.jsx)("div",{className:"bg-white shadow overflow-hidden sm:rounded-md max-h-[600px] overflow-y-auto",children:(0,a.jsx)("ul",{className:"divide-y divide-gray-200",children:0===t.length?(0,a.jsx)("li",{className:"p-4 text-center text-gray-500",children:"예약 내역이 없습니다."}):t.map(e=>(0,a.jsxs)("li",{className:"p-4 hover:bg-gray-50",children:[(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-lg font-bold",children:e.name}),(0,a.jsx)("p",{className:"text-gray-600",children:e.phone})]}),(0,a.jsxs)("div",{className:"text-right",children:[(0,a.jsx)("p",{className:"text-blue-600 font-bold",children:new Date(e.dateTime).toLocaleString()}),(0,a.jsx)("p",{className:"text-gray-500",children:e.programId||"상담 예약"})]})]}),e.notes&&(0,a.jsx)("div",{className:"mt-2 text-gray-700 bg-gray-100 p-2 rounded text-sm",children:e.notes})]},e.id))})})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h2",{className:"text-2xl font-bold mb-4",children:"후기 관리"}),c?(0,a.jsx)("p",{children:"로딩 중..."}):(0,a.jsx)("div",{className:"bg-white shadow overflow-hidden sm:rounded-md max-h-[600px] overflow-y-auto",children:(0,a.jsx)("ul",{className:"divide-y divide-gray-200",children:0===n.length?(0,a.jsx)("li",{className:"p-4 text-center text-gray-500",children:"등록된 후기가 없습니다."}):n.map(e=>(0,a.jsxs)("li",{className:"p-4 hover:bg-gray-50",children:[(0,a.jsxs)("div",{className:"flex justify-between items-start mb-2",children:[(0,a.jsx)("h3",{className:"font-bold text-lg line-clamp-1",children:e.title}),(0,a.jsx)("button",{onClick:()=>u(e.id),className:"text-red-500 text-sm hover:underline shrink-0 ml-2",children:"삭제"})]}),(0,a.jsxs)("p",{className:"text-sm text-gray-600 mb-2",children:[e.author," | ",new Date(e.createdAt).toLocaleDateString()," | ★",e.rating]}),(0,a.jsx)("p",{className:"text-gray-700 text-sm line-clamp-2",children:e.comment})]},e.id))})})]})]})]}):null}}},e=>{e.O(0,[977,441,255,358],()=>e(e.s=345)),_N_E=e.O()}]);